======MODEL TRAINING======

[init] device: cpu
[data] loading datasets...
[data] train samples: 280, val samples: 16
[data] train batches per epoch: 140
[model] model initialized and moved to device
[train] starting training loop
[train] epoch 1/10, batch 10/140, loss=0.8034
[train] epoch 1/10, batch 20/140, loss=0.8201
[train] epoch 1/10, batch 30/140, loss=1.1400
[train] epoch 1/10, batch 40/140, loss=1.0261
[train] epoch 1/10, batch 50/140, loss=1.0721
[train] epoch 1/10, batch 60/140, loss=0.9478
[train] epoch 1/10, batch 70/140, loss=0.5572
[train] epoch 1/10, batch 80/140, loss=0.2369
[train] epoch 1/10, batch 90/140, loss=0.4534
[train] epoch 1/10, batch 100/140, loss=0.3932
[train] epoch 1/10, batch 110/140, loss=0.4300
[train] epoch 1/10, batch 120/140, loss=0.6666
[train] epoch 1/10, batch 130/140, loss=1.0112
[train] epoch 1/10, batch 140/140, loss=0.5577
Epoch [1/10] Avg loss: 0.6538
[checkpoint] saved epoch 1 to outputs/checkpoints/model_epoch_1.pth
[train] epoch 2/10, batch 10/140, loss=0.5229
[train] epoch 2/10, batch 20/140, loss=0.2454
[train] epoch 2/10, batch 30/140, loss=0.3100
[train] epoch 2/10, batch 40/140, loss=0.5383
[train] epoch 2/10, batch 50/140, loss=0.5288
[train] epoch 2/10, batch 60/140, loss=0.5125
[train] epoch 2/10, batch 70/140, loss=0.3392
[train] epoch 2/10, batch 80/140, loss=0.3106
[train] epoch 2/10, batch 90/140, loss=0.3921
[train] epoch 2/10, batch 100/140, loss=0.5278
[train] epoch 2/10, batch 110/140, loss=0.4432
[train] epoch 2/10, batch 120/140, loss=0.2661
[train] epoch 2/10, batch 130/140, loss=0.2719
[train] epoch 2/10, batch 140/140, loss=0.2518
Epoch [2/10] Avg loss: 0.3773
[checkpoint] saved epoch 2 to outputs/checkpoints/model_epoch_2.pth
[train] epoch 3/10, batch 10/140, loss=0.2745
[train] epoch 3/10, batch 20/140, loss=0.1498
[train] epoch 3/10, batch 30/140, loss=0.2244
[train] epoch 3/10, batch 40/140, loss=0.2380
[train] epoch 3/10, batch 50/140, loss=0.2811
[train] epoch 3/10, batch 60/140, loss=0.0778
[train] epoch 3/10, batch 70/140, loss=0.1388
[train] epoch 3/10, batch 80/140, loss=0.3752
[train] epoch 3/10, batch 90/140, loss=0.0862
[train] epoch 3/10, batch 100/140, loss=0.2215
[train] epoch 3/10, batch 110/140, loss=0.2285
[train] epoch 3/10, batch 120/140, loss=0.2630
[train] epoch 3/10, batch 130/140, loss=0.3509
[train] epoch 3/10, batch 140/140, loss=0.2918
Epoch [3/10] Avg loss: 0.2813
[checkpoint] saved epoch 3 to outputs/checkpoints/model_epoch_3.pth
[train] epoch 4/10, batch 10/140, loss=0.1895
[train] epoch 4/10, batch 20/140, loss=0.2194
[train] epoch 4/10, batch 30/140, loss=0.2148
[train] epoch 4/10, batch 40/140, loss=0.1359
[train] epoch 4/10, batch 50/140, loss=0.1063
[train] epoch 4/10, batch 60/140, loss=0.2697
[train] epoch 4/10, batch 70/140, loss=0.3650
[train] epoch 4/10, batch 80/140, loss=0.1459
[train] epoch 4/10, batch 90/140, loss=0.2579
[train] epoch 4/10, batch 100/140, loss=0.1655
[train] epoch 4/10, batch 110/140, loss=0.1798
[train] epoch 4/10, batch 120/140, loss=0.3288
[train] epoch 4/10, batch 130/140, loss=0.2501
[train] epoch 4/10, batch 140/140, loss=0.1746
Epoch [4/10] Avg loss: 0.2234
[checkpoint] saved epoch 4 to outputs/checkpoints/model_epoch_4.pth
[train] epoch 5/10, batch 10/140, loss=0.2532
[train] epoch 5/10, batch 20/140, loss=0.2377
[train] epoch 5/10, batch 30/140, loss=0.1844
[train] epoch 5/10, batch 40/140, loss=0.0597
[train] epoch 5/10, batch 50/140, loss=0.1705
[train] epoch 5/10, batch 60/140, loss=0.0796
[train] epoch 5/10, batch 70/140, loss=0.2070
[train] epoch 5/10, batch 80/140, loss=0.1240
[train] epoch 5/10, batch 90/140, loss=0.2041
[train] epoch 5/10, batch 100/140, loss=0.2250
[train] epoch 5/10, batch 110/140, loss=0.2039
[train] epoch 5/10, batch 120/140, loss=0.3699
[train] epoch 5/10, batch 130/140, loss=0.1347
[train] epoch 5/10, batch 140/140, loss=0.2052
Epoch [5/10] Avg loss: 0.1845
[checkpoint] saved epoch 5 to outputs/checkpoints/model_epoch_5.pth
[train] epoch 6/10, batch 10/140, loss=0.1956
[train] epoch 6/10, batch 20/140, loss=0.1938
[train] epoch 6/10, batch 30/140, loss=0.0755
[train] epoch 6/10, batch 40/140, loss=0.1864
[train] epoch 6/10, batch 50/140, loss=0.1495
[train] epoch 6/10, batch 60/140, loss=0.1101
[train] epoch 6/10, batch 70/140, loss=0.2435
[train] epoch 6/10, batch 80/140, loss=0.1244
[train] epoch 6/10, batch 90/140, loss=0.0899
[train] epoch 6/10, batch 100/140, loss=0.1126
[train] epoch 6/10, batch 110/140, loss=0.2625
[train] epoch 6/10, batch 120/140, loss=0.1959
[train] epoch 6/10, batch 130/140, loss=0.0737
[train] epoch 6/10, batch 140/140, loss=0.1925
Epoch [6/10] Avg loss: 0.1608
[checkpoint] saved epoch 6 to outputs/checkpoints/model_epoch_6.pth
[train] epoch 7/10, batch 10/140, loss=0.0894
[train] epoch 7/10, batch 20/140, loss=0.1394
[train] epoch 7/10, batch 30/140, loss=0.1660
[train] epoch 7/10, batch 40/140, loss=0.1796
[train] epoch 7/10, batch 50/140, loss=0.1225
[train] epoch 7/10, batch 60/140, loss=0.1563
[train] epoch 7/10, batch 70/140, loss=0.2352
[train] epoch 7/10, batch 80/140, loss=0.1169
[train] epoch 7/10, batch 90/140, loss=0.1963
[train] epoch 7/10, batch 100/140, loss=0.1810
[train] epoch 7/10, batch 110/140, loss=0.1332
[train] epoch 7/10, batch 120/140, loss=0.0981
[train] epoch 7/10, batch 130/140, loss=0.1024
[train] epoch 7/10, batch 140/140, loss=0.0994
Epoch [7/10] Avg loss: 0.1426
[checkpoint] saved epoch 7 to outputs/checkpoints/model_epoch_7.pth
[train] epoch 8/10, batch 10/140, loss=0.1442
[train] epoch 8/10, batch 20/140, loss=0.0552
[train] epoch 8/10, batch 30/140, loss=0.1311
[train] epoch 8/10, batch 40/140, loss=0.1585
[train] epoch 8/10, batch 50/140, loss=0.1837
[train] epoch 8/10, batch 60/140, loss=0.1118
[train] epoch 8/10, batch 70/140, loss=0.2040
[train] epoch 8/10, batch 80/140, loss=0.1055
[train] epoch 8/10, batch 90/140, loss=0.1361
[train] epoch 8/10, batch 100/140, loss=0.1583
[train] epoch 8/10, batch 110/140, loss=0.1131
[train] epoch 8/10, batch 120/140, loss=0.1043
[train] epoch 8/10, batch 130/140, loss=0.2349
[train] epoch 8/10, batch 140/140, loss=0.1715
Epoch [8/10] Avg loss: 0.1278
[checkpoint] saved epoch 8 to outputs/checkpoints/model_epoch_8.pth
[train] epoch 9/10, batch 10/140, loss=0.1309
[train] epoch 9/10, batch 20/140, loss=0.1561
[train] epoch 9/10, batch 30/140, loss=0.0918
[train] epoch 9/10, batch 40/140, loss=0.0649
[train] epoch 9/10, batch 50/140, loss=0.0954
[train] epoch 9/10, batch 60/140, loss=0.0468
[train] epoch 9/10, batch 70/140, loss=0.1100
[train] epoch 9/10, batch 80/140, loss=0.0900
[train] epoch 9/10, batch 90/140, loss=0.1427
[train] epoch 9/10, batch 100/140, loss=0.0966
[train] epoch 9/10, batch 110/140, loss=0.0931
[train] epoch 9/10, batch 120/140, loss=0.0739
[train] epoch 9/10, batch 130/140, loss=0.1106
[train] epoch 9/10, batch 140/140, loss=0.1420
Epoch [9/10] Avg loss: 0.1118
[checkpoint] saved epoch 9 to outputs/checkpoints/model_epoch_9.pth
[train] epoch 10/10, batch 10/140, loss=0.1491
[train] epoch 10/10, batch 20/140, loss=0.1339
[train] epoch 10/10, batch 30/140, loss=0.1229
[train] epoch 10/10, batch 40/140, loss=0.1350
[train] epoch 10/10, batch 50/140, loss=0.0785
[train] epoch 10/10, batch 60/140, loss=0.1137
[train] epoch 10/10, batch 70/140, loss=0.1013
[train] epoch 10/10, batch 80/140, loss=0.0678
[train] epoch 10/10, batch 90/140, loss=0.1269
[train] epoch 10/10, batch 100/140, loss=0.0871
[train] epoch 10/10, batch 110/140, loss=0.1810
[train] epoch 10/10, batch 120/140, loss=0.1143
[train] epoch 10/10, batch 130/140, loss=0.1401
[train] epoch 10/10, batch 140/140, loss=0.0692
Epoch [10/10] Avg loss: 0.1083

======MODEL EVAL======

[1/15] image_id=0 predicted_people=6 saved=outputs/figures/test_img_0_count_6.png
[2/15] image_id=1 predicted_people=22 saved=outputs/figures/test_img_1_count_22.png
[3/15] image_id=2 predicted_people=5 saved=outputs/figures/test_img_2_count_5.png
[4/15] image_id=3 predicted_people=3 saved=outputs/figures/test_img_3_count_3.png
[5/15] image_id=4 predicted_people=16 saved=outputs/figures/test_img_4_count_16.png
[6/15] image_id=5 predicted_people=8 saved=outputs/figures/test_img_5_count_8.png
[7/15] image_id=6 predicted_people=18 saved=outputs/figures/test_img_6_count_18.png
[8/15] image_id=7 predicted_people=17 saved=outputs/figures/test_img_7_count_17.png
[9/15] image_id=8 predicted_people=20 saved=outputs/figures/test_img_8_count_20.png
[10/15] image_id=9 predicted_people=14 saved=outputs/figures/test_img_9_count_14.png
[11/15] image_id=10 predicted_people=9 saved=outputs/figures/test_img_10_count_9.png
[12/15] image_id=11 predicted_people=19 saved=outputs/figures/test_img_11_count_19.png
[13/15] image_id=12 predicted_people=6 saved=outputs/figures/test_img_12_count_6.png
[14/15] image_id=13 predicted_people=12 saved=outputs/figures/test_img_13_count_12.png
[15/15] image_id=14 predicted_people=16 saved=outputs/figures/test_img_14_count_16.png

=== Summary ===
Checkpoint: outputs/checkpoints/model_epoch_10.pth
Score threshold: 0.5
Raw detections (before threshold): 225
Detections kept (after threshold): 191
Avg kept per image: 12.73